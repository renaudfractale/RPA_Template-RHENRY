<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <script src="https://cdn.metroui.org.ua/v4/js/metro.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.3.0/dist/sql-asm.js"></script>
    <script src="./dataOk.js"></script>
    <!-- Metro 4 -->
    <link rel="stylesheet" href="https://cdn.metroui.org.ua/v4/css/metro-all.min.css">
  </head>
  <body>
       <div id="mynetwork"></div>
      <script type="text/javascript" defer>
        // Instantiate our network object.
        var container = document.getElementById('mynetwork');
        container.innerHTML=""
        var nodes = []
        var edges = []
        let nodesraw = Object.keys(data)
        let dico =  new Map()
        for (let index = 0; index < nodesraw.length; index++) {
            let node = nodesraw[index];
            dico.set(node,index)
            nodes.push({
                id : index,
                label : node
            })
        }
        nodesraw.forEach(node => {
            let childs = Object.keys(data[node].InvokeWorkflowFile)
            childs.forEach(child => {
                edges.push({
                    from : dico.get(node),
                    to :  dico.get(child),
                    force : data[node].InvokeWorkflowFile[child]*100,
                    arrows: {
                            to: {
                                enabled: true,
                                type: "arrow",
                            },
                            },
                }) 
            });
            
        });




        var data = {
            nodes: nodes,
            edges: edges
        };
        //console.log(data)
        var options = {
            height: '800px',
            width: '1600px',
            nodes: {
            shape: 'dot',
            scaling: {
                customScalingFunction: function (min,max,total,value) {
                return value/total;
                },
                min:5,
                max:150
            }
            }
        };
        this.network = new vis.Network(container, data, options);
        
</script>
    <!-- Metro 4 -->
    </body>
</html>